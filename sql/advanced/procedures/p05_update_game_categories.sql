-- ============================================
-- EXERCICE: ProcÃ©dure avec curseur (LOOP)
-- NIVEAU: ðŸ”´ AvancÃ© - ProcÃ©dures StockÃ©es
-- CONCEPTS: CURSOR, LOOP, HANDLER
--
-- ðŸ“š Documentation MariaDB :
-- - [CURSOR](https://mariadb.com/kb/en/cursor-overview/)
-- - [LOOP](https://mariadb.com/kb/en/loop/)
-- - [Handlers](https://mariadb.com/kb/en/declare-handler/)
--
-- ðŸŽ¯ OBJECTIF PÃ‰DAGOGIQUE:
-- Utiliser un curseur pour parcourir un ensemble de rÃ©sultats
-- ligne par ligne et effectuer un traitement sur chacune.
--
-- ðŸ’¡ CURSEUR (CURSOR):
-- Un curseur permet de parcourir les rÃ©sultats d'une requÃªte
-- une ligne Ã  la fois, comme une boucle for.
--
-- Ã‰tapes:
-- 1. DECLARE CURSOR FOR SELECT ...
-- 2. DECLARE CONTINUE HANDLER FOR NOT FOUND
-- 3. OPEN cursor
-- 4. LOOP + FETCH
-- 5. CLOSE cursor
--
-- ============================================
-- CONSIGNE:
-- CrÃ©ez une procÃ©dure 'sp_update_game_categories' qui parcourt
-- tous les jeux avec un score et effectue un traitement.
--
-- Nom: sp_update_game_categories
-- ParamÃ¨tres: AUCUN
--
-- Action:
-- Parcourir tous les jeux avec metacritic NOT NULL
-- (Dans cet exercice, on ne fait qu'un parcours de dÃ©monstration)
--
-- Retour: SELECT 'Categories updated' AS result;
--
-- ðŸ’¡ STRUCTURE:
-- DELIMITER //
-- CREATE PROCEDURE sp_update_game_categories()
-- BEGIN
--     DECLARE done INT DEFAULT FALSE;
--     DECLARE gid INT;
--     DECLARE score INT;
--     
--     -- DÃ©finir le curseur
--     DECLARE cur CURSOR FOR 
--         SELECT id, metacritic 
--         FROM games 
--         WHERE metacritic IS NOT NULL 
--         LIMIT 100;  -- Limiter pour la dÃ©mo
--     
--     -- Handler pour fin de curseur
--     DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
--     
--     OPEN cur;
--     
--     read_loop: LOOP
--         FETCH cur INTO gid, score;
--         IF done THEN
--             LEAVE read_loop;
--         END IF;
--         
--         -- Traitement sur chaque jeu
--         -- (ici on ne fait rien, c'est juste une dÃ©mo)
--         
--     END LOOP;
--     
--     CLOSE cur;
--     SELECT 'Categories updated' AS result;
-- END //
-- DELIMITER ;
--
-- ðŸ’¡ UTILISATION:
-- CALL sp_update_game_categories();
--
-- ðŸ’¡ QUAND UTILISER UN CURSEUR ?
-- - Rarement ! Les curseurs sont lents.
-- - PrÃ©fÃ©rez les opÃ©rations ensemblistes (UPDATE WHERE ...)
-- - Utile uniquement pour logique complexe ligne par ligne
-- ============================================
