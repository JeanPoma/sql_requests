-- ============================================
-- EXERCICE: Filtrage avec CTE (Common Table Expression)
-- NIVEAU: ðŸŸ¡ IntermÃ©diaire
-- CONCEPTS: CTE (WITH clause), sous-requÃªtes, structuration du code
--
-- ðŸ“š Ressources SQLZoo recommandÃ©es :
-- - Tutorial 9 : https://sqlzoo.net/wiki/Window_LAG
--
-- ðŸŽ¯ OBJECTIF PÃ‰DAGOGIQUE:
-- Apprendre Ã  utiliser les CTE (Common Table Expressions) pour structurer
-- vos requÃªtes complexes et amÃ©liorer la lisibilitÃ©.
--
-- ðŸ’¡ RAPPEL DE SYNTAXE:
-- WITH nom_cte AS (
--   SELECT ...
--   FROM ...
--   WHERE ...
-- )
-- SELECT ...
-- FROM nom_cte
-- WHERE ...;
--
-- LES CTE C'EST COMME:
-- - Des sous-requÃªtes nommÃ©es et rÃ©utilisables
-- - Un moyen de dÃ©composer une requÃªte complexe en Ã©tapes
-- - Plus lisible que des sous-requÃªtes imbriquÃ©es
--
-- ============================================
-- CONSIGNE:
-- Utilisez une CTE pour filtrer les jeux avec ratings_count >= 1000,
-- puis retournez le TOP 20 par Metacritic.
--
-- Colonnes attendues: name, metacritic, ratings_count
--
-- Ã‰tapes:
-- 1. CrÃ©er une CTE qui filtre les jeux populaires (ratings_count >= 1000)
-- 2. Depuis cette CTE, sÃ©lectionner le TOP 20 par Metacritic
--
-- Ordre: metacritic DESC, ratings_count DESC
-- Limit: 20
--
-- ðŸ’¡ STRUCTURE ATTENDUE:
-- WITH popular_games AS (
--   SELECT name, metacritic, ratings_count
--   FROM games
--   WHERE ratings_count >= 1000
--     AND metacritic IS NOT NULL
-- )
-- SELECT *
-- FROM popular_games
-- ORDER BY metacritic DESC, ratings_count DESC
-- LIMIT 20;
--
-- ðŸ’¡ POURQUOI UTILISER UNE CTE ICI ?
-- Dans cet exemple simple, ce n'est pas obligatoire, mais c'est une
-- bonne pratique pour les requÃªtes complexes. Les CTE permettent:
-- - De dÃ©composer la logique en Ã©tapes claires
-- - De documenter chaque Ã©tape avec un nom explicite
-- - De rÃ©utiliser une CTE plusieurs fois dans la mÃªme requÃªte
-- ============================================
