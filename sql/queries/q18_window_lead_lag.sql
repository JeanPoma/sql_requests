-- ============================================
-- EXERCICE: LEAD/LAG (fonctions de fen√™tre avanc√©es)
-- NIVEAU: üî¥ Avanc√©
-- CONCEPTS: LEAD, LAG, window functions, analyses temporelles
--
-- üéØ OBJECTIF P√âDAGOGIQUE:
-- Ma√Ætriser LEAD et LAG pour acc√©der aux lignes pr√©c√©dentes/suivantes
-- dans un ensemble ordonn√©, utile pour les comparaisons temporelles.
--
-- üí° LEAD vs LAG:
-- - LAG(col, n): acc√®de √† la ligne n positions AVANT
-- - LEAD(col, n): acc√®de √† la ligne n positions APR√àS
--
-- ============================================
-- CONSIGNE:
-- Utilisez LAG/LEAD pour comparer le Metacritic d'un jeu
-- √† celui du jeu pr√©c√©dent de la m√™me plateforme
-- (ordonn√© par year DESC, puis metacritic DESC).
--
-- Colonnes attendues: platform, name, year, metacritic, prev_meta, diff_meta
--
-- Calculs:
-- - prev_meta: Metacritic du jeu pr√©c√©dent (LAG)
-- - diff_meta: metacritic - prev_meta (diff√©rence)
--
-- üí° STRUCTURE:
-- SELECT platform, name, year, metacritic,
--        LAG(metacritic, 1) OVER (
--          PARTITION BY platform
--          ORDER BY year DESC, metacritic DESC
--        ) AS prev_meta,
--        metacritic - LAG(metacritic, 1) OVER (...) AS diff_meta
-- FROM games
-- JOIN game_platforms ...
-- WHERE metacritic IS NOT NULL
--
-- Filtres: metacritic IS NOT NULL
-- Ordre: platform ASC, year DESC, metacritic DESC
-- Limit: 100
--
-- üí° CAS D'USAGE:
-- - Analyser l'√©volution des scores dans le temps
-- - D√©tecter des tendances (am√©lioration/d√©gradation)
-- - Comparer des performances relatives
-- ============================================
