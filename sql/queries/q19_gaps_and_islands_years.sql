-- ============================================
-- EXERCICE: Gaps & Islands (sÃ©quences continues)
-- NIVEAU: ðŸ”´ AvancÃ©
-- CONCEPTS: SÃ©quences, ROW_NUMBER, patterns complexes
--
-- ðŸŽ¯ OBJECTIF PÃ‰DAGOGIQUE:
-- RÃ©soudre le problÃ¨me classique "Gaps and Islands":
-- identifier des sÃ©quences continues dans des donnÃ©es.
--
-- ðŸ’¡ QU'EST-CE QUE "GAPS & ISLANDS" ?
-- - Islands (Ã®les): groupes de valeurs consÃ©cutives
-- - Gaps (trous): absences dans la sÃ©quence
--
-- Exemple avec des annÃ©es: 2010, 2011, 2012, [GAP], 2015, 2016
-- â†’ 2 islands: [2010-2012] et [2015-2016]
--
-- ============================================
-- CONSIGNE:
-- DÃ©tectez, par plateforme, les "Ã®les" d'annÃ©es contiguÃ«s
-- oÃ¹ il existe au moins 1 jeu avec metacritic NOT NULL.
--
-- Sortie: platform, start_year, end_year, span_years
--
-- ðŸ’¡ TECHNIQUE (Astuce classique):
-- 1. Pour chaque ligne, calculer: year - ROW_NUMBER()
--    â†’ Les annÃ©es consÃ©cutives auront la mÃªme valeur
-- 2. Grouper par cette valeur pour identifier les Ã®les
-- 3. Calculer MIN(year) et MAX(year) par Ã®le
--
-- ðŸ’¡ STRUCTURE SUGGÃ‰RÃ‰E:
-- WITH numbered AS (
--   SELECT DISTINCT platform, year,
--          year - ROW_NUMBER() OVER (PARTITION BY platform ORDER BY year) AS grp
--   FROM games JOIN game_platforms ...
--   WHERE metacritic IS NOT NULL AND year IS NOT NULL
-- )
-- SELECT platform,
--        MIN(year) AS start_year,
--        MAX(year) AS end_year,
--        MAX(year) - MIN(year) + 1 AS span_years
-- FROM numbered
-- GROUP BY platform, grp
-- ORDER BY platform, start_year;
--
-- ðŸ’¡ CAS D'USAGE:
-- - Analyser la continuitÃ© de la production
-- - Identifier les pÃ©riodes d'inactivitÃ©
-- - DÃ©tecter des patterns temporels
-- ============================================
