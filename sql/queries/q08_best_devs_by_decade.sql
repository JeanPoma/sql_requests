-- ============================================
-- EXERCICE: Meilleurs dÃ©veloppeurs par dÃ©cennie
-- NIVEAU: ðŸŸ¡ IntermÃ©diaire
-- CONCEPTS: Calculs de dates, GROUP BY, jointures, window functions
--
-- ðŸ“š Ressources SQLZoo recommandÃ©es :
-- - Tutorial 5 : https://sqlzoo.net/wiki/SUM_and_COUNT
-- - Tutorial 8+ : https://sqlzoo.net/wiki/Window_functions
--
-- ðŸŽ¯ OBJECTIF PÃ‰DAGOGIQUE:
-- Apprendre Ã  crÃ©er des groupements temporels (dÃ©cennies)
-- et Ã  extraire le TOP N par groupe avec window functions.
--
-- ðŸ’¡ RAPPEL: Calculer une dÃ©cennie
-- FLOOR(year / 10) * 10
-- Exemples:
-- - 1998 â†’ FLOOR(1998/10)*10 = 199*10 = 1990
-- - 2015 â†’ FLOOR(2015/10)*10 = 201*10 = 2010
--
-- ============================================
-- CONSIGNE:
-- Calculez, par dÃ©cennie, les 3 meilleurs studios (developers)
-- par Metacritic moyen.
--
-- Colonnes attendues: decade, developer, meta_avg, n_games
--
-- Ã‰tapes:
-- 1. DÃ©river la dÃ©cennie depuis year: FLOOR(year/10)*10 AS decade
-- 2. Joindre games -> game_developers -> developers
-- 3. Grouper par (decade, developer)
-- 4. Calculer AVG(metacritic) et COUNT(*) par groupe
-- 5. Utiliser une window function pour classer par dÃ©cennie
-- 6. Filtrer pour garder uniquement le TOP 3 par dÃ©cennie
--
-- Filtres:
-- - year IS NOT NULL
-- - metacritic IS NOT NULL
-- - n_games >= 5 (dÃ©veloppeurs productifs uniquement)
--
-- Ordre final: decade ASC, meta_avg DESC
--
-- ðŸ’¡ APPROCHE AVEC CTE:
-- WITH dev_stats AS (
--   SELECT FLOOR(year/10)*10 AS decade,
--          developer,
--          AVG(metacritic) AS meta_avg,
--          COUNT(*) AS n_games
--   FROM ... JOIN ...
--   GROUP BY decade, developer
--   HAVING n_games >= 5
-- ),
-- ranked AS (
--   SELECT *,
--          RANK() OVER (PARTITION BY decade ORDER BY meta_avg DESC) AS rnk
--   FROM dev_stats
-- )
-- SELECT decade, developer, meta_avg, n_games
-- FROM ranked
-- WHERE rnk <= 3;
--
-- ðŸ’¡ QUESTION Ã€ EXPLORER:
-- Les grands studios des annÃ©es 2000 sont-ils toujours au top en 2010-2020 ?
-- ============================================
